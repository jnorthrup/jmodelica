# 
#    Copyright (C) 2009 Modelon AB
#
#    This program is free software: you can redistribute it and/or modify
#    it under the terms of the Common Public License as published by
#    IBM, version 1.0 of the License.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY. See the Common Public License for more details.
#
#    You should have received a copy of the Common Public License
#    along with this program.  If not, see
#     <http://www.ibm.com/developerworks/library/os-cpl.html/>.


# Name of the executable
EXE = vdp@EXEEXT@ 

# Name of shared library
SHARED = vdp@SHAREDEXT@

# Object files to be included in the executable
OBJS = vdp_main.@OBJEXT@ \
	vdp.@OBJEXT@

# Object files to be included in the shared library
SHAREDOBJS = vdp.@OBJEXT@

# Additional libraries
ADDLIBS =

# Additional flags for compilation (e.g., include flags)
ADDINCFLAGS =

# CHANGEME: Directory to the sources for the (example) problem definition
# files
SRCDIR = @srcdir@
VPATH = @srcdir@

##########################################################################
#  Usually, you don't have to change anything below.                     #
##########################################################################

# C Compiler command
CC = @CC@

# C Compiler options
CFLAGS = @CFLAGS@ -DJMI_AD=JMI_AD_NONE
CLINKFLAGS = 

SHARED_LDFLAGS = @SHARED_LDFLAGS@

# Directory with header files
JMIINCDIR = @includedir@ 

# Directory with jmi.a
JMILIBDIR = @libdir@
exec_prefix = @exec_prefix@
prefix = @prefix@

# Include paths for compilation
LIBS = @jmilib@ @ipoptlib@ #@ADDLIBS@

# Include paths for compilation
INCL =  -I$(JMIINCDIR) -I@IPOPT_INC@

all: $(EXE) $(SHARED)

# Create the executable
.SUFFIXES: .cpp .c .o .obj

# Create the executable
$(EXE): $(OBJS)
	$(CC) $(CLINKFLAGS) $(CFLAGS) -o $@ $(OBJS) $(LIBS)

# Create the shared library
$(SHARED): $(OBJS)
	$(CC) $(SHARED_LDFLAGS) $(CLINKFLAGS) $(CFLAGS) -o $@ $(SHAREDOBJS) $(LIBS)

# Compile
.c.o:
	$(CC) $(CFLAGS) $(INCL) -c -o $@ $<

clean:
	rm -rf $(EXE) $(OBJS) $(SHARED)

