<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>JModelica: Internal functions of the JMI Model interface.</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.7 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Internal functions of the JMI Model interface.</h1>Documentation of the internal functions and data structures of the JMI Model interface.  
<a href="#_details">More...</a>
<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Modules</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jmi__internal__defines.html">Defines</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defined constants. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jmi__internal__typedefs.html">Typedefs</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Internal typedefs. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jmi__function__typedefs.html">Function typedefs</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function signatures to be used in the generated code. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jmi__func__t.html">The jmi_func_t struct</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Functions for creating, deleting and evaluating <a class="el" href="structjmi__func__t.html" title="Data structure for representing a single function .">jmi_func_t</a> functions. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__jmi__structs__init.html">The jmi_t, jmi_dae_t, jmi_init_t, and jmi_opt_t structs</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Functions for initialization of the <a class="el" href="structjmi__t.html" title="The main struct of the JMI Model interface containing dimension information and pointers...">jmi_t</a>, <a class="el" href="structjmi__dae__t.html" title="Struct describing a DAE model.">jmi_dae_t</a>, <a class="el" href="structjmi__init__t.html" title="A struct containing a DAE initialization system.">jmi_init_t</a>, and <a class="el" href="structjmi__opt__t.html" title="A struct containing functions and information about the interval definition and optimization...">jmi_opt_t</a> structs. <br></td></tr>

<p>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Misc__internal.html">Miscanellous</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Miscanellous functions. <br></td></tr>

<p>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Documentation of the internal functions and data structures of the JMI Model interface. 
<p>
The JMI Model interface is supported by internal data structures and functions which are described in the following. The internal data structures support the the use of CppAD (see <a href="http://www.coin-or.org/CppAD/">http://www.coin-or.org/CppAD/</a>) a package for automatic differentiation. CppAD is based in operator overloading in and is written in C++. Accordingly, the JMI Runtime Library needs to be compiled with a C++ compiler in order to use CppAD. On the other hand, for some applications it is desirable to compile the Runtime Library using a pure C compiler. In order to accommodate these two situations, there are two sets of typedefs for some of the internal data structures: one set for the case of C++ compilation with CppAD and one set of typedefs for the case of C compilation without CppAD. By setting the constant JMI_AD to either JMI_AD_NONE or JMI_AD_CPPAD (typically done by a compiler directive (switch -D if gcc is used)), the correct set of typedefs are included.<h2><a class="anchor" name="jmi_func_t">
Representation of functions</a></h2>
All the mathematical functions defined in the JMI Model interface are functions of independent variables contained in <img class="formulaInl" alt="$z$" src="form_52.png">. It is therefore convenient to introduce an abstraction of a general function <img class="formulaInl" alt="$F(z)$" src="form_57.png">, which can then be used to represent all functions in the JMI Model interface. This abstraction is materilized by the <a class="el" href="structjmi__func__t.html" title="Data structure for representing a single function .">jmi_func_t</a> struct. This struct contains function pointers for evaluation of the function and its derivatives, as well as sparsity information. In addition, <a class="el" href="structjmi__func__t.html" title="Data structure for representing a single function .">jmi_func_t</a> may contain data structures for evaluation of derivatives by means of CppAD.<h2><a class="anchor" name="jmi_jmi_t">
JMI Model interface structs</a></h2>
The main struct of the JMI model interface is <a class="el" href="structjmi__t.html" title="The main struct of the JMI Model interface containing dimension information and pointers...">jmi_t</a>. An instance of this struct is passed as the first argument to most functions in the JMI model interface and can be viewed as an object corresponding to a particular model. <a class="el" href="structjmi__t.html" title="The main struct of the JMI Model interface containing dimension information and pointers...">jmi_t</a> contains dimension information of the model and one or several of the structs<ul>
<li><a class="el" href="structjmi__dae__t.html" title="Struct describing a DAE model.">jmi_dae_t</a> which contains the DAE residual function.</li><li><a class="el" href="structjmi__init__t.html" title="A struct containing a DAE initialization system.">jmi_init_t</a> which contains the DAE initialization functions.</li><li><a class="el" href="structjmi__opt__t.html" title="A struct containing functions and information about the interval definition and optimization...">jmi_opt_t</a> which contains the cost function, the constraint functions, and a specification of the optimization interval. If one of the structs are not present in <a class="el" href="structjmi__t.html" title="The main struct of the JMI Model interface containing dimension information and pointers...">jmi_t</a>, the corresponding pointer is set to NULL.</li></ul>
<h2><a class="anchor" name="jmi_internal_init">
Initialization of interal JMI Model  interface structs</a></h2>
interface structs<p>
Instances of <a class="el" href="structjmi__t.html" title="The main struct of the JMI Model interface containing dimension information and pointers...">jmi_t</a> are created by a call to <a class="el" href="group__jmi__struct.html#g4c5b88adacb39f4dfb1148fbcbcd3ae8" title="Create a new jmi_t struct.">jmi_new</a>, which is a function that is typically defined in the generated model code. The creation of a <a class="el" href="structjmi__t.html" title="The main struct of the JMI Model interface containing dimension information and pointers...">jmi_t</a> struct proceeds in three steps:<ul>
<li>First, a raw struct is created by the function <a class="el" href="group__jmi__structs__init.html#g3755e4b93c162f02849cb13e5493ff5c">jmi_init</a>. In this function, the dimensions of the variable vectors are set, but no substructs are initialized.</li><li>Then the <a class="el" href="structjmi__dae__t.html" title="Struct describing a DAE model.">jmi_dae_t</a>, <a class="el" href="structjmi__init__t.html" title="A struct containing a DAE initialization system.">jmi_init_t</a>, and <a class="el" href="structjmi__opt__t.html" title="A struct containing functions and information about the interval definition and optimization...">jmi_opt_t</a> structs are initialized by the functions <a class="el" href="group__jmi__structs__init.html#g95d497c290a68b1eac5305dd3675a4bb">jmi_dae_init</a>, <a class="el" href="group__jmi__structs__init.html#ga34f18b7f495b034a467b95b3a8a9179">jmi_init_init</a>, and <a class="el" href="group__jmi__structs__init.html#gb7926914d291b98c2c39a90a597a6d01">jmi_opt_init</a> respectively. In these function calls, the corresponding function pointers are set and new <a class="el" href="structjmi__func__t.html" title="Data structure for representing a single function .">jmi_func_t</a> structs are created.</li><li>Finlly, the the AD structs (<a class="el" href="structjmi__func__ad__t.html" title="Contains data structures for CppAD.">jmi_func_ad_t</a>) are set up in the function call <a class="el" href="group__jmi__struct.html#g191e9e8e38af75004d218241636494dc">jmi_ad_init</a>. Notice that the variable vectors should have been initialized prior to the call to <a class="el" href="group__jmi__struct.html#g191e9e8e38af75004d218241636494dc">jmi_ad_init</a>. Such initialization usually requires access to XML meta-data files, which is done outside of the generated code. Accordingly, the AD initialization must be done from the user code after <a class="el" href="group__jmi__struct.html#g4c5b88adacb39f4dfb1148fbcbcd3ae8" title="Create a new jmi_t struct.">jmi_new</a> has returned a valid <a class="el" href="structjmi__t.html" title="The main struct of the JMI Model interface containing dimension information and pointers...">jmi_t</a> instance.</li></ul>
<p>
Typically, <a class="el" href="group__jmi__structs__init.html#g3755e4b93c162f02849cb13e5493ff5c">jmi_init</a>, <a class="el" href="group__jmi__structs__init.html#g95d497c290a68b1eac5305dd3675a4bb">jmi_dae_init</a>, <a class="el" href="group__jmi__structs__init.html#ga34f18b7f495b034a467b95b3a8a9179">jmi_init_init</a>, and <a class="el" href="group__jmi__structs__init.html#gb7926914d291b98c2c39a90a597a6d01">jmi_opt_init</a> are called from within the <a class="el" href="group__jmi__struct.html#g4c5b88adacb39f4dfb1148fbcbcd3ae8" title="Create a new jmi_t struct.">jmi_new</a> function. The function jmi_ad_init is then called from the user code after the variable vectors has been initialized. </div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Feb 9 15:37:33 2009 for JModelica by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.7 </small></address>
</body>
</html>
