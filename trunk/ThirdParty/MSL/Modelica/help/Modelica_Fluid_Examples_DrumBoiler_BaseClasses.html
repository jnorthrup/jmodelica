<HTML>
<HEAD>
<TITLE>Modelica.Fluid.Examples.DrumBoiler.BaseClasses</TITLE>
<META name="HTML-Generator" content="Dymola">
<META name="description" content="&quot;Additional components for drum boiler example&quot;">
<style type="text/css">
*       { font-size: 10pt; font-family: Arial,sans-serif; }
pre     { font-size:  9pt; font-family: Courier,monospace;}
h4      { font-size: 10pt; font-weight: bold; color: green; }
h3      { font-size: 11pt; font-weight: bold; color: green; }
h2      { font-size: 13pt; font-weight: bold; color: green; }
address {                  font-weight: normal} 
td      { solid #000; vertical-align:top; }
th      { solid #000; vertical-align:top; font-weight: bold; }
table   { solid #000; border-collapse: collapse;}
</style>
</HEAD>
<BODY><P>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE BaseClasses<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><A NAME="Modelica.Fluid.Examples.DrumBoiler.BaseClasses"></A><A HREF="Modelica_Fluid_Examples_DrumBoiler.html#Modelica.Fluid.Examples.DrumBoiler"
>Modelica.Fluid.Examples.DrumBoiler</A>.BaseClasses</H2>
<B>Additional components for drum boiler example</B>
<P>
<P><H3>Information</H3></P>
Extends from <A HREF="Modelica_Fluid_Icons_BaseClassLibrary.html#Modelica.Fluid.Icons.BaseClassLibrary"
>Modelica.Fluid.Icons.BaseClassLibrary</A> (Icon for library).
<P><H3>Package Content</H3><p>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2 >
<TR><TH >Name</TH><TH>Description</TH></TR>
<TR><TD><IMG SRC="Modelica.Fluid.Examples.DrumBoiler.BaseClasses.EquilibriumDrumBoilerS.png" ALT="Modelica.Fluid.Examples.DrumBoiler.BaseClasses.EquilibriumDrumBoiler" WIDTH=20  HEIGHT=20 ALIGN = TOP >&nbsp;<A HREF="Modelica_Fluid_Examples_DrumBoiler_BaseClasses.html#Modelica.Fluid.Examples.DrumBoiler.BaseClasses.EquilibriumDrumBoiler"
>EquilibriumDrumBoiler</A>
</TD><TD>Simple Evaporator with two states, see Astroem, Bell: Drum-boiler dynamics, Automatica 36, 2000, pp.363-378</TD></TR>
</TABLE>
<HR>
<!--[if supportFields]><span style='mso-element:field-begin'></span>
<span style='mso-spacerun:yes'></span>XE EquilibriumDrumBoiler<![endif]-->
<!--[if supportFields]><span style='mso-element:field-end'></span><![endif]-->
<H2><IMG SRC="Modelica.Fluid.Examples.DrumBoiler.BaseClasses.EquilibriumDrumBoilerI.png" ALT="Modelica.Fluid.Examples.DrumBoiler.BaseClasses.EquilibriumDrumBoiler" ALIGN=RIGHT BORDER=1 WIDTH=80  HEIGHT=80 >
<A NAME="Modelica.Fluid.Examples.DrumBoiler.BaseClasses.EquilibriumDrumBoiler"></A><A HREF="Modelica_Fluid_Examples_DrumBoiler_BaseClasses.html#Modelica.Fluid.Examples.DrumBoiler.BaseClasses"
>Modelica.Fluid.Examples.DrumBoiler.BaseClasses</A>.EquilibriumDrumBoiler</H2>
<B>Simple Evaporator with two states, see Astroem, Bell: Drum-boiler dynamics, Automatica 36, 2000, pp.363-378</B><p>
<IMG SRC="Modelica.Fluid.Examples.DrumBoiler.BaseClasses.EquilibriumDrumBoilerD.png" ALT="Modelica.Fluid.Examples.DrumBoiler.BaseClasses.EquilibriumDrumBoiler">
<P><H3>Information</H3></P>
<PRE></pre>
Model of a simple evaporator with two states. The model assumes two-phase equilibrium inside the component; saturated steam goes out of the steam outlet.
<p>
References: Astroem, Bell: Drum-boiler dynamics, Automatica 36, 2000, pp.363-378
<pre></PRE><P>
Extends from <A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPort"
>Modelica.Fluid.Interfaces.PartialTwoPort</A> (Partial component with two ports).
<P><H3>Parameters</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Default</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium"
>PartialMedium</A></TD><TD>Medium in the component</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Mass"
>Mass</A></TD><TD>m_D</TD><TD>&nbsp;</TD><TD>mass of surrounding drum metal [kg]</TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificHeatCapacity"
>SpecificHeatCapacity</A></TD><TD>cp_D</TD><TD>&nbsp;</TD><TD>specific heat capacity of drum metal [J/(kg.K)]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V_t</TD><TD>&nbsp;</TD><TD>total volume inside drum [m3]</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Assumptions</B></TD></TR>
<TR><TD>Boolean</TD><TD>allowFlowReversal</TD><TD>system.allowFlowReversal</TD><TD>= true to allow flow reversal, false restricts to design direction (port_a -&gt; port_b)</TD></TR>
<TR bgcolor="#e0e0e0"><TD colspan=4>Dynamics</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</A></TD><TD>energyDynamics</TD><TD>system.energyDynamics</TD><TD>Formulation of energy balance</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Dynamics</A></TD><TD>massDynamics</TD><TD>system.massDynamics</TD><TD>Formulation of mass balance</TD></TR>
<TR bgcolor="#c0c0c0"><TD colspan=4><B>Initialization</B></TD></TR>
<TR><TD><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>AbsolutePressure</A></TD><TD>p_start</TD><TD>system.p_start</TD><TD>Start value of pressure [Pa]</TD></TR>
<TR><TD><A HREF="Modelica_SIunits.html#Modelica.SIunits.Volume"
>Volume</A></TD><TD>V_l_start</TD><TD>V_t/2</TD><TD>Start value of liquid volumeStart value of volume [m3]</TD></TR>
</TABLE>
<P><H3>Connectors</H3><P>
<TABLE BORDER=1 CELLSPACING=0 CELLPADDING=2>
<TR><TH>Type</TH><TH>Name</TH><TH>Description</TH></TR>
<TR><TD colspan="2">replaceable package Medium</TD><TD>Medium in the component</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_a"
>FluidPort_a</A></TD><TD>port_a</TD><TD>Fluid connector a (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.FluidPort_b"
>FluidPort_b</A></TD><TD>port_b</TD><TD>Fluid connector b (positive design flow direction is from port_a to port_b)</TD></TR>
<TR><TD><A HREF="Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>HeatPort_a</A></TD><TD>heatPort</TD><TD>&nbsp;</TD></TR>
<TR><TD>output <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>RealOutput</A></TD><TD>V</TD><TD>liquid volume</TD></TR>
</TABLE>
<P><H3>Modelica definition</H3>
<PRE>
<font color="blue">model</font> EquilibriumDrumBoiler <font color="darkgreen">
  &quot;Simple Evaporator with two states, see Astroem, Bell: Drum-boiler dynamics, Automatica 36, 2000, pp.363-378&quot;</font>
  <font color="blue">extends </font><A HREF="Modelica_Fluid_Interfaces.html#Modelica.Fluid.Interfaces.PartialTwoPort"
>Modelica.Fluid.Interfaces.PartialTwoPort</A>(
    <font color="blue">final </font>port_a_exposesState=true,
    <font color="blue">final </font>port_b_exposesState=true,
    <font color="blue">redeclare </font><font color="blue">replaceable </font><font color="blue">package</font> Medium = 
        Modelica.Media.Water.StandardWater 
        <font color="blue">constrainedby </font>Modelica.Media.Interfaces.PartialTwoPhaseMedium);
  <font color="blue">import </font><A HREF="Modelica_SIunits_Conversions.html#Modelica.SIunits.Conversions"
>Modelica.SIunits.Conversions</A>.*;
  <font color="blue">import </font><A HREF="Modelica_Constants.html#Modelica.Constants"
>Modelica.Constants</A>;
  <font color="blue">import </font><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types"
>Modelica.Fluid.Types</A>;

  <font color="blue">parameter </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.Mass"
>SI.Mass</A> m_D <font color="darkgreen">&quot;mass of surrounding drum metal&quot;</font>;
  <font color="blue">parameter </font><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificHeatCapacity"
>Medium.SpecificHeatCapacity</A> cp_D <font color="darkgreen">
    &quot;specific heat capacity of drum metal&quot;</font>;
  <font color="blue">parameter </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.Volume"
>SI.Volume</A> V_t <font color="darkgreen">&quot;total volume inside drum&quot;</font>;
  <font color="blue">parameter </font><A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p_start=system.p_start <font color="darkgreen">
    &quot;Start value of pressure&quot;</font>;
  <font color="blue">parameter </font><A HREF="Modelica_SIunits.html#Modelica.SIunits.Volume"
>SI.Volume</A> V_l_start=V_t/2 <font color="darkgreen">
    &quot;Start value of liquid volumeStart value of volume&quot;</font>;

  <font color="darkgreen">// Assumptions</font>
  <font color="blue">parameter </font>Boolean allowFlowReversal = system.allowFlowReversal <font color="darkgreen">
    &quot;allow flow reversal, false restricts to design direction (port_a -&gt; port_b)&quot;</font>;
  <font color="blue">parameter </font><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Types.Dynamics</A> energyDynamics=system.energyDynamics <font color="darkgreen">
    &quot;Formulation of energy balance&quot;</font>;
  <font color="blue">parameter </font><A HREF="Modelica_Fluid_Types.html#Modelica.Fluid.Types.Dynamics"
>Types.Dynamics</A> massDynamics=system.massDynamics <font color="darkgreen">
    &quot;Formulation of mass balance&quot;</font>;

<textblock type="annotcomp" expanded="false">  <A HREF="Modelica_Thermal_HeatTransfer_Interfaces.html#Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a"
>Modelica.Thermal.HeatTransfer.Interfaces.HeatPort_a</A> heatPort;
  <A HREF="Modelica_Blocks_Interfaces.html#Modelica.Blocks.Interfaces.RealOutput"
>Modelica.Blocks.Interfaces.RealOutput</A> V <font color="darkgreen">&quot;liquid volume&quot;</font>;</textblock>

  Medium.SaturationProperties sat <font color="darkgreen">
    &quot;State vector to compute saturation properties&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.AbsolutePressure"
>Medium.AbsolutePressure</A> p(start=p_start, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;pressure inside drum boiler&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> T <font color="darkgreen">&quot;temperature inside drum boiler&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Volume"
>SI.Volume</A> V_v <font color="darkgreen">&quot;volume of vapour phase&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Volume"
>SI.Volume</A> V_l(start=V_l_start, stateSelect=StateSelect.prefer) <font color="darkgreen">
    &quot;volumes of liquid phase&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> h_v=<font color="red">Medium.dewEnthalpy</font>(sat) <font color="darkgreen">
    &quot;specific enthalpy of vapour&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> h_l=<font color="red">Medium.bubbleEnthalpy</font>(sat) <font color="darkgreen">
    &quot;specific enthalpy of liquid&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rho_v=<font color="red">Medium.dewDensity</font>(sat) <font color="darkgreen">&quot;density in vapour phase&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Density"
>Medium.Density</A> rho_l=<font color="red">Medium.bubbleDensity</font>(sat) <font color="darkgreen">&quot;density in liquid phase&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Mass"
>SI.Mass</A> m <font color="darkgreen">&quot;total mass of drum boiler&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.Energy"
>SI.Energy</A> U <font color="darkgreen">&quot;internal energy&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.Temperature"
>Medium.Temperature</A> T_D=heatPort.T <font color="darkgreen">&quot;temperature of drum&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.HeatFlowRate"
>SI.HeatFlowRate</A> q_F=heatPort.Q_flow <font color="darkgreen">&quot;heat flow rate from furnace&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> h_W=<font color="red">inStream</font>(port_a.h_outflow) <font color="darkgreen">
    &quot;Feed water enthalpy (specific enthalpy close to feedwater port when mass flows in to the boiler)&quot;</font>;
  <A HREF="Modelica_Media_Interfaces_PartialMedium.html#Modelica.Media.Interfaces.PartialMedium.SpecificEnthalpy"
>Medium.SpecificEnthalpy</A> h_S=<font color="red">inStream</font>(port_b.h_outflow) <font color="darkgreen">
    &quot;steam enthalpy (specific enthalpy close to steam port when mass flows in to the boiler)&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>SI.MassFlowRate</A> qm_W=port_a.m_flow <font color="darkgreen">&quot;feed water mass flow rate&quot;</font>;
  <A HREF="Modelica_SIunits.html#Modelica.SIunits.MassFlowRate"
>SI.MassFlowRate</A> qm_S=port_b.m_flow <font color="darkgreen">&quot;steam mass flow rate&quot;</font>;
<font color="darkgreen">/*outer Modelica.Fluid.Components.FluidOptions fluidOptions
    &quot;Global default options&quot;;*/</font>
<font color="blue">equation </font>
<font color="darkgreen">// balance equations</font>
  m = rho_v*V_v + rho_l*V_l + m_D <font color="darkgreen">&quot;Total mass&quot;</font>;
  U = rho_v*V_v*h_v + rho_l*V_l*h_l - p*V_t + m_D*cp_D*T_D <font color="darkgreen">&quot;Total energy&quot;</font>;
  <font color="blue">if </font>massDynamics == Types.Dynamics.SteadyState<font color="blue"> then</font>
    0 = qm_W + qm_S <font color="darkgreen">&quot;Steady state mass balance&quot;</font>;
  <font color="blue">else</font>
    <font color="red">der</font>(m) = qm_W + qm_S <font color="darkgreen">&quot;Dynamic mass balance&quot;</font>;
  <font color="blue">end if</font>;
  <font color="blue">if </font>energyDynamics == Types.Dynamics.SteadyState<font color="blue"> then</font>
    0 = q_F + port_a.m_flow*<font color="red">actualStream</font>(port_a.h_outflow)
            + port_b.m_flow*<font color="red">actualStream</font>(port_b.h_outflow) <font color="darkgreen">
      &quot;Steady state energy balance&quot;</font>;
  <font color="blue">else</font>
    <font color="red">der</font>(U) = q_F
            + port_a.m_flow*<font color="red">actualStream</font>(port_a.h_outflow)
            + port_b.m_flow*<font color="red">actualStream</font>(port_b.h_outflow) <font color="darkgreen">
      &quot;Dynamic energy balance&quot;</font>;
  <font color="blue">end if</font>;
  V_t = V_l + V_v;

<font color="darkgreen">// Properties of saturated liquid and steam</font>
  sat.psat = p;
  sat.Tsat = T;
  sat.Tsat =<font color="red"> Medium.saturationTemperature</font>(p);

<font color="darkgreen">// ideal heat transfer between metal and water</font>
  T_D = T;

<font color="darkgreen">// boundary conditions at the ports</font>
  port_a.p = p;
  port_a.h_outflow = h_l;
  port_b.p = p;
  port_b.h_outflow = h_v;

<font color="darkgreen">// liquid volume</font>
  V = V_l;

<font color="darkgreen">// Check that two-phase equilibrium is actually possible</font>
  <font color="red">assert</font>(p &lt; Medium.fluidConstants[1].criticalPressure - 10000,
    &quot;Evaporator model requires subcritical pressure&quot;);
<font color="blue">initial </font><font color="blue">equation </font>
<font color="darkgreen">// Initial conditions</font>
  <font color="darkgreen">// Note: p represents the energy as it is constrained by T_sat</font>
  <font color="blue">if </font>energyDynamics == Types.Dynamics.FixedInitial<font color="blue"> then</font>
    p = p_start;
  <font color="blue">elseif </font>energyDynamics == Types.Dynamics.SteadyStateInitial<font color="blue"> then</font>
    <font color="red">der</font>(p) = 0;
  <font color="blue">end if</font>;

  <font color="blue">if </font>massDynamics == Types.Dynamics.FixedInitial<font color="blue"> then</font>
    V_l = V_l_start;
  <font color="blue">elseif </font>energyDynamics == Types.Dynamics.SteadyStateInitial<font color="blue"> then</font>
    <font color="red">der</font>(V_l) = 0;
  <font color="blue">end if</font>;

<textblock type="annotcomp" expanded="false"><font color="blue">end </font>EquilibriumDrumBoiler;
</PRE>
<HR>
<address>HTML-documentation generated by <a href="http://www.Dymola.com/">Dymola</a> Sun Jan 17 21:11:53 2010.
</address></BODY>
</HTML>
